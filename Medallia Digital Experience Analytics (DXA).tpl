___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Medallia Digital Experience Analytics (DXA)",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Formerly known as Decibel by Medallia and Medallia DXA and Decibel Insights",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "decibelClientId",
    "displayName": "decibelClientId",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "POSITIVE_NUMBER"
      }
    ],
    "valueHint": "1st integer in URL"
  },
  {
    "type": "TEXT",
    "name": "decibelInstanceId",
    "displayName": "decibelInstanceId",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "POSITIVE_NUMBER"
      }
    ],
    "valueHint": "2nd integer in URL"
  },
  {
    "type": "TEXT",
    "name": "decibelScriptPrefix",
    "displayName": "decibelScriptPrefix",
    "simpleValueType": true,
    "defaultValue": "https://cdn.decibelinsight.net/i/",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "REGEX",
        "args": [
          "^https\\:\\/\\/.*decibel.*\\/$"
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const injectScript = require('injectScript');
const createQueue = require('createQueue');
const setInWindow = require('setInWindow');
const copyFromWindow = require('copyFromWindow');
//const getUrl = require('getUrl');
//const Math = require('Math');

// Get template parameters
const decibelClientId = data.decibelClientId;
const decibelInstanceId = data.decibelInstanceId;
const decibelScriptPrefix = data.decibelScriptPrefix;

// Build script URL
const decibelScriptUrl = decibelScriptPrefix + decibelClientId + '/' + decibelInstanceId + '/di.js';

// Initialize Decibel Insight
const initializeDecibelInsight = () => {
  // Set up error tracking array
  const copyFromWindow = require('copyFromWindow');
  const existingDa = copyFromWindow('_da_');
  
  if (!existingDa) {
    setInWindow('_da_', []);
    setInWindow('_da_.err', []);
  }
  
  // Create DecibelInsight queue
  const decibelInsightQueue = createQueue('decibelInsight');
  setInWindow('DecibelInsight', 'decibelInsight');
  
  log('Medallia DXA: Initialized DecibelInsight queue');
};

// Initialize the tracking
initializeDecibelInsight();

// Inject the Decibel Insight script
injectScript(decibelScriptUrl, () => {
  log('Medallia DXA: Script loaded successfully');
  data.gtmOnSuccess();
}, () => {
  log('Medallia DXA: Failed to load script');
  data.gtmOnFailure();
}, 'decibelInsight');


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.decibelinsight.net/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_da_"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "DecibelInsight"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "decibelInsight"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_da_.err"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 6/9/2025, 9:02:11 AM


